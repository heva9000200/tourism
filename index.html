<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.4.1.js"
      integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
      crossorigin="anonymous"
    ></script>
  </head>
  <link rel="stylesheet" href="style/all.css" />
  <body>
    <div class="container-fluid header">
      <h1 class="text-center text-white py-5">
        高雄旅遊網
      </h1>
      <div class="container">
        <div class="d-flex justify-content-center my-5">
          <select name="" id="area" class="area">
            <option value="" disabled selected hidden>----請選擇----</option>
            <option value="三民區">三民區</option>
            <option value="內門區">內門區</option>
            <option value="美濃區">美濃區</option>
            <option value="大樹區">大樹區</option>
            <option value="小港區">小港區</option>
            <option value="六龜區">六龜區</option>
            <option value="仁武區">仁武區</option>
            <option value="左營區">左營區</option>
            <option value="田寮區">田寮區</option>
            <option value="永安區">永安區</option>
            <option value="鼓山區">鼓山區</option>
            <option value="杉林區">杉林區</option>
            <option value="那瑪夏">那瑪夏</option>
            <option value="岡山區">岡山區</option>
            <option value="楠梓區">楠梓區</option>
            <option value="前鎮區">前鎮區</option>
            <option value="苓雅區">苓雅區</option>
            <option value="茂林區">茂林區</option>
            <option value="梓官區">梓官區</option>
            <option value="旗津區">旗津區</option>
            <option value="桃園區">桃園區</option>
            <option value="前金區">前金區</option>
            <option value="鳳山區">鳳山區</option>
          </select>
        </div>

        <section class="bg-white popularDestination">
          <h2 class="h5 mb-3">熱門行政區</h2>
          <div class="d-flex justify-content-around">
            <button class="btn btn-primary btnOne" id="Lingya">
              苓雅區
            </button>
            <button class="btn btn-primary btnTwo" id="Sanmin">
              三民區
            </button>
            <button class="btn btn-primary btnThree" id="Xinxing">
              新興區
            </button>
            <button class="btn btn-primary btnFour" id="Nanzi">
              楠梓區
            </button>
          </div>
        </section>

        <div>
          <div class="dottedLine mt-5"></div>
          <div class="downIcon">
            <div
              class="
          triangle"
            ></div>
          </div>
        </div>

        <section class="mt-5">
          <h2 id="title" class="text-center my-5"></h2>
          <div class="row " id="data"></div>
        </section>

        <div class="top">
          <button>
            <img src="img/btn_goTop.png" alt="" />
          </button>
        </div>
      </div>

      <section class="footer py-5 text-center">
        <h3>高雄旅遊網</h3>
        <p class="text-warning">資料來源 高雄市政府</p>
      </section>
    </div>
    <script>
      const content = document.querySelector('#data')
      const Sanmin = document.querySelector('#Sanmin')
      const title = document.querySelector('#title')
      const area = document.querySelector('#area')
      const Lingya = document.querySelector('#Lingya')
      const Xinxing = document.querySelector('#Xinxing')
      const Nanzi = document.querySelector('#Nanzi')
      const url =
        'https://data.kcg.gov.tw/api/action/datastore_search?resource_id=92290ee5-6e61-456f-80c0-249eae2fcc97'
      fetch(url)
        .then(res => res.json())
        .then(json => {
          let dNone = ''
          let deleM = ''
          let data = json.result.records

          area.addEventListener('change', e => {
            let txt = ''
            for (let i = 0; i < data.length; i++) {
              if (data[i].Zone == e.target.value) {
                if (data[i].Ticketinfo == '') {
                  dNone = 'd-none'
                }
                title.innerHTML = data[i].Zone
                txt += updata(
                  data[i].Picture1,
                  data[i].Name,
                  data[i].Zone,
                  data[i].Opentime,
                  data[i].Add,
                  data[i].Tel,
                  dNone,
                  data[i].Ticketinfo
                )
              }
            }
            content.innerHTML = txt
          })

          Sanmin.addEventListener('click', e => {
            let txt = ''
            for (let i = 0; i < data.length; i++) {
              if (data[i].Zone == '三民區') {
                if (data[i].Ticketinfo == '') {
                  dNone = 'd-none'
                }
                title.innerHTML = data[i].Zone
                txt += updata(
                  data[i].Picture1,
                  data[i].Name,
                  data[i].Zone,
                  data[i].Opentime,
                  data[i].Add,
                  data[i].Tel,
                  dNone,
                  data[i].Ticketinfo
                )
              }
              content.innerHTML = txt
            }
          })

          Lingya.addEventListener('click', e => {
            let txt = ''
            for (let i = 0; i < data.length; i++) {
              if (data[i].Zone == '苓雅區') {
                if (data[i].Ticketinfo == '') {
                  dNone = 'd-none'
                }
                title.innerHTML = data[i].Zone
                txt += updata(
                  data[i].Picture1,
                  data[i].Name,
                  data[i].Zone,
                  data[i].Opentime,
                  data[i].Add,
                  data[i].Tel,
                  dNone,
                  data[i].Ticketinfo
                )
              }
              content.innerHTML = txt
            }
          })

          Xinxing.addEventListener('click', e => {
            let txt = ''
            for (let i = 0; i < data.length; i++) {
              if (data[i].Zone == '新興區') {
                if (data[i].Ticketinfo == '') {
                  dNone = 'd-none'
                }
                title.innerHTML = data[i].Zone
                txt += updata(
                  data[i].Picture1,
                  data[i].Name,
                  data[i].Zone,
                  data[i].Opentime,
                  data[i].Add,
                  data[i].Tel,
                  dNone,
                  data[i].Ticketinfo
                )
              }
              content.innerHTML = txt
            }
          })

          Nanzi.addEventListener('click', e => {
            let txt = ''
            for (let i = 0; i < data.length; i++) {
              if (data[i].Zone == '楠梓區') {
                if (data[i].Ticketinfo == '') {
                  dNone = 'd-none'
                }
                title.innerHTML = data[i].Zone
                txt += updata(
                  data[i].Picture1,
                  data[i].Name,
                  data[i].Zone,
                  data[i].Opentime,
                  data[i].Add,
                  data[i].Tel,
                  dNone,
                  data[i].Ticketinfo
                )
              }
              content.innerHTML = txt
            }
          })
        })

      function updata(
        Picture1,
        Name,
        Zone,
        Opentime,
        Add,
        Tel,
        dNone,
        Ticketinfo
      ) {
        return `
                  <div class="col-6 d-flex">
                    <div class="card mb-5 flex-fill">
                      <div class="bgCover text-white d-flex align-items-end justify-content-between"style="background-image: url('${Picture1}'); width: 100%; height: 200px;">
                        <h2 class="ml-4">${Name}</h2>
                        <p class="mr-4">${Zone}</p>
                      </div>
                      <div class="card-body ">
                        <p class="mb-2">
                          <img src="img/icons_clock.png" alt="" /><span class="ml-2 align-self-stretch">${Opentime}</span>
                        </p>
                        <p class="mb-2">
                          <img src="img/icons_pin.png" alt="" /><span class="ml-2 align-self-stretch">${Add}</span>
                        </p>
                          <div class="d-flex justify-content-between">
                            <p class="mb-2">
                              <img
                                src="img/icons_phone.png"
                                alt=""
                                style="margin-left: 3px;"/><span class="ml-2">${Tel}</span>
                              </p>
                              <p class="${dNone}">
                                <img src="img/icons_tag.png" alt="" /><span class="ml-2">${Ticketinfo}</span
                                >
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>
                  `
      }

      $(document).ready(function() {
        $('.top button').click(function() {
          $('html,body').animate({ scrollTop: 0 }, 333)
        })
      })
    </script>
  </body>
</html>
